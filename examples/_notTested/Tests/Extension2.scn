<?xml version="1.0"?>
<Node name="root" dt="0.002"  gravity="0 -9800 0">

	<RequiredPlugin pluginName="BeamAdapter"/>
	 <VisualStyle displayFlags="hideVisualModels showBehaviorModels showCollisionModels hideMappings showForceFields" />
	<Node name="topoLines_suture">
		<WireRestShape template="Rigid" printLog="0" name="sutureRestShape" length="100"  straightLength="100" spireDiameter="1000.0" spireHeight="0.0"
					    densityOfBeams="10 0" numEdges="150" numEdgesCollis="150 0"  youngModulus="2e9"/>		
		<EdgeSetTopologyContainer name="meshLinesSuture" />
		<EdgeSetTopologyModifier   name="Modifier" />
		<EdgeSetTopologyAlgorithms name="TopoAlgo"   template="Rigid" />
		<EdgeSetGeometryAlgorithms name="GeomAlgo"   template="Rigid" />
		<MechanicalObject template="Rigid" name="dofTopo1" />
	</Node>	

	<Node name="AdaptiveBeam">
		<EulerImplicit rayleighStiffness="0.08" rayleighMass="0.08" />
		<BTDLinearSolver /> 

		<EdgeSetTopologyContainer name="meshSuture" />
		<EdgeSetTopologyModifier   name="Modifier" />
		<EdgeSetTopologyAlgorithms name="TopoAlgo"   template="Rigid" />
		<EdgeSetGeometryAlgorithms name="GeomAlgo"   template="Rigid" />	
	
		<MechanicalObject template="Rigid" name="DOFs" showIndices="0"/> 

		<WireBeamInterpolation name="InterpolSuture" WireRestShape="@../topoLines_suture/sutureRestShape" radius="0.1" printLog="0" dofsAndBeamsAligned="false"/> 
		<AdaptiveBeamForceFieldAndMass name="SutureForceField" interpolation="@InterpolSuture" massDensity="1e-2" elongationFactor="1" />
		<SutureController template="Rigid" name="m_ircontroller" printLog="0"  startingPos="0 0 20 0 0 0 1" interpolation="@InterpolSuture"  threshold="0.25" maxBendingAngle="1e6"/>
	<!--	<AdaptiveBeamLengthConstraint interpolation="@InterpolSuture"/>	-->

		<LinearSolverConstraintCorrection printLog="false" wire_optimization="true"/>

		<FixedConstraint name="FixedConstraint" indices="0" />
		
		<Node name="ConstrainedFames">
			<MechanicalObject name="AttachedFrame" template="Rigid" position="0 0 0 0 0 0 1" />
			<AdaptiveBeamMapping  name="FrameMap"  interpolation="@../InterpolSuture" useCurvAbs="1" printLog="0" points="100 0 0" mapMasses="0" mapForces="0"/> 
			<ConstantForceField points="0" forces="1e5 0 0  0 0 0 1" />
		</Node>	
		
		<Node name="Collis">
				<RegularGrid name="test"
				nx="120" ny="1" nz="1"
				xmin="0.0" xmax="100"
				ymin="0" ymax="0"
				zmin="0" zmax="0"
				/>
				<MechanicalObject name="CollisionDOFs"/>
				<AdaptiveBeamMapping  name="collisMap"  interpolation="@../InterpolSuture" useCurvAbs="1" printLog="0" mapMasses="0" mapForces="0"/> 
				<Line proximity="0.0" group="1"  selfCollision="1" />
				<Point proximity="0.0" group="1" selfCollision="1"/>
		</Node>	
		
		<Node name="VisuSuture">
			<MechanicalObject name="Quads" />
			<QuadSetTopologyContainer  name="ContainerSuture" />
			<QuadSetTopologyModifier   name="Modifier" />
			<QuadSetTopologyAlgorithms name="TopoAlgo"  template="Vec3d" />
			<QuadSetGeometryAlgorithms name="GeomAlgo"  template="Vec3d" />
			<Edge2QuadTopologicalMapping nbPointsOnEachCircle="6" radius="0.25" input="@../../topoLines_suture/meshLinesSuture" output="@ContainerSuture" flipNormals="true"/>
			<AdaptiveBeamMapping  name="VisuMapCath" useCurvAbs="1" printLog="0" interpolation="@../InterpolSuture" input="@../DOFs" output="@Quads" isMechanical="false"  mapMasses="0" mapForces="0" />

			<Node name="VisuOgl">
				<VisualModel  name="VisualBody" />
				<IdentityMapping input="@../Quads" output="@VisualBody"/>
			</Node>	
		</Node>
	</Node>
	
	<Node name="beam">
        <EulerImplicit rayleighStiffness="0.08" rayleighMass="0.08" />
        <BTDLinearSolver />
        <MechanicalObject template="Rigid" name="DOFs" position="	0 0 -20 0 0 0 1  
																	10 0 -20 0 0 0 1  
																	20 0 -20 0 0 0 1  
																	30 0 -20 0 0 0 1  
																	40 0 -20 0 0 0 1  
																	50 0 -20 0 0 0 1  
																	60 0 -20 0 0 0 1  
																	70 0 -20 0 0 0 1
																	80 0 -20 0 0 0 1  
																	90 0 -20 0 0 0 1  
																	100 0 -20 0 0 0 1" />
        <Mesh name="lines" lines="0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10" />

        <FixedConstraint name="FixedConstraint" indices="0" />
		<UniformMass totalMass="0.0314159" />
        <BeamFEMForceField name="FEM" radius="0.1" youngModulus="2e9" />
		
		<ConstantForceField points="10" forces="1e5 0 0  0 0 0 1" />
	</Node>
</Node>

