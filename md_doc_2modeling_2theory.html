<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BeamAdapter: theory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">BeamAdapter
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_doc_2modeling_2theory.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">theory</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page presents the mechanical basis of the beam model and how the internal forces are computed.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Modeling Theory</h1>
<p>Beam elements are used to model instruments (or anatomical structures) for which the length is greater than the other transverse dimensions. For the general introduction of beam theory and equations, see p.509 [5] .</p>
<p>The particular nature of such objects generally leads to large geometric deformations, which is notorious for being computationally demanding. Examples of objects with this geometry are abundant in medical simulation. <br  />
</p>
<p>The approach that is used in the plugin is initially based on a linear beam analysis. But it extends this representation by a series of optimizations particularly suited for real-time animation. By using a Corotational approach, our model can handle the important geometric non-linearity due to large changes in the shape of the object.</p>
<p><br  />
</p>
<h2><a class="anchor" id="autotoc_md12"></a>
1. Corotational beam model</h2>
<p>To model the deformation of any solid body whose geometry and mechanical characteristics are similar to a wire, rod or beam, we use a representation based on three-dimensional beam theory <em>see Przemieniecki (1985) [2]</em>, where the elementary stiffness matrix Ke is a 12 × 12 symmetric matrix that relates angular and spacial positions of each end of a beam element to the forces and torques applied to them:</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/Matrix.jpg" alt="" align="left" width="700" class="inline"/> <br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p>parameters:</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/Matrix_param.jpg" alt="" align="left" width="700" class="inline"/> <br  />
 <br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p>The assumption of the corotational model is that the deformations remain ”small” at the level of each element. Thus, a local frame is defined for each beam. Thus, the force **f<sub>e</sub>** at the level of the element is equal to:</p>
<p>**f<sub>e</sub> = K<sub>e</sub> (u - u<sub>0</sub>)** (1)</p>
<p>where <b>u</b> and **u<sub>0</sub>** reflect respectively the actual and the initial configuration of the beam, in the local frame of the beam. Since the stiffness matrix **K<sub>e</sub>** is initially calculated in local coordinates, it is necessary to introduce transformation matrices changing the reference frame from a local to a global coordinate system. In order to determine the stiffness property of the complete structure, a common reference frame must be established for all unassembled structural elements so that all the displacements and their corresponding forces will be referred to a common (global) coordinate system. We need a matrix relationship between the variation of the position δ <b>u</b> in the local coordinate system and the variation of the node position δ <b>q</b> in the global coordinates.</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/BeamFrames.jpg" alt="" align="left" width="700" class="inline"/> <br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p>This relationship is expressed by the matrix equation:</p>
<p>δ <b>u</b> = <b>Λ(q)</b> δ <b>q</b> (2)</p>
<p>where <b>Λ(q)</b> is a matrix obtained from the direction cosines of angles between the local and global coordinate systems. The linearization of the element force-displacement equation is obtained in global coordinates:</p>
<p>δ <b>F(q)</b> = [**Λ<sup>T</sup>(q)** <b>Ke</b> <b>Λ(q)</b>] δ <b>q</b> (3)</p>
<p>The model can be combined with the computation of a mass matrix to obtain mechanical dynamic model. We then use the equation 3 to compute the system. One important feature of this model is that the interpolation is performed segment by segment between only two frames. Additionally, these frames are the independent Degrees of Freedom (DoFs) of the system.</p>
<p><br  />
</p>
<h2><a class="anchor" id="autotoc_md13"></a>
2. B-splines , Bézier Splines</h2>
<p>B-splines in general and Bézier splines in particulary can see in <em>[1]</em> or more detail in <em>[3]</em>. A spline tool can see at <em>[4]</em>. Here assumed several general formula. In general, a Bézier curve order n is determined by n + 1 control points (characteristic polygone) $P_{i, 0 \le i \le n}$ ,06i6n. Its trajectory is:</p>
<p>$B(t)$=$\sum_{i = 0}^{n} \widehat{B}_{i,n}(t).P_i$</p>
<p>Where $\widehat{B}_{i,n}(t)$ are Bernstein polynomial given by:</p>
<p>$\widehat{B}_{i,n}(t)=\binom{n}{i}.t^{i}.(1-t)^{n-i}$</p>
<p>The most usually used is the cubic Bézier , where trajectory is given by</p>
<p>$(1 − t)^3.P_0 + 3.(1 − t)^2.t.P_1 + 3.t^2.(1 − t).P_3 + t^3.P_3$</p>
<p><br  />
</p>
<h1><a class="anchor" id="autotoc_md14"></a>
Implementation</h1>
<p>In the following, we describe the main components of the implementation of BeamAdapter Plugin. For a full description of a BeamAdapter scene, check the <a href="https://github.com/sofa-framework/BeamAdapter/blob/master/doc/modeling/implementation.md">implementation documentation</a> and here is the documentation of the <a href="https://sofa-framework.github.io/BeamAdapter/">API C++ code</a></p>
<p>One of the central component of the beams is the shape function. The description of the shape function relies on:</p><ul>
<li>One topology of edges</li>
<li>A set of frames with Dofs (3 translations, 3 rotations) that corresponds to the points of the topology</li>
<li>A spline (3d order) support for each edge</li>
</ul>
<h2><a class="anchor" id="autotoc_md15"></a>
WireRestShape</h2>
<p>This component allows to define the rest shape of Wire instrument such as a catheter (modeled with a set of beams), the numerical parameters used in the simulation, and the topology used for the visualisation.</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/CatheterModeling.jpg" alt="" align="left" width="700" class="inline"/> <br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p>Several physical and geometry parameters can be defined using SOFA Data such as the <b>densityOfBeams</b>, <b>straightLength</b>, <b>youngModulus</b>, <b>numEdges</b>, etc. See <a href="https://github.com/sofa-framework/BeamAdapter/blob/master/doc/modeling/implementation.md">implementation documentation</a> for the full list.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
WireBeamInterpolation</h2>
<p>This component is one of the most important in the modeling of catheter devices: It contains the interpolation functions that are dynamically updated when the catheter is deployed. Inside the component, the geometric support of each beams is a cubic spline. From the two frames at the extremities of the beam, we define the 4 control points of the cubic splines. The construction is made to guaranty a C1 continuity between splines.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
AdaptiveBeamForceFieldAndMass</h2>
<p>This component computes the Force and the mass using a beam formulation. The computation is based on a « corotational approach ».</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/BeamModeling.jpg" alt="" align="left" width="700" class="inline"/> <br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p>From the two 6DOF position of the nodes of the beam, we extract 4 points for defining a spline. Using this spline, we can find one central frame for the beam (in red in the figure). There is only one rotation that is not determined (along the axis of the spline). To find this twiting orientation, we use a slerp. The computation of the deformations of the beams are done in this frame and suppose linear deformations using beam elements (Timoshenko beams) .</p>
<h2><a class="anchor" id="autotoc_md18"></a>
AdaptiveBeamMapping</h2>
<p>This mapping allows to drive the Mechanical Object of the collision object thanks to the position and velocity of the Mechanical Object of the parent node. In the opposite direction, the Mapping also allows to transfer the forces and the constraints from the collision model to the DOFs (the nodes of the beam). The hypothesis of beam FEM is based on interpolation function. This why this MultiAdpativeBeamMapping will rely on the interpolation defined in the WireBeamInterpolations. However, for the specific case of catheter instruments, several concentric instruments can be inserted. Then the mapping has to be done with the good interpolation functions</p>
<p><img src="https://raw.githubusercontent.com/sofa-framework/BeamAdapter/master/doc/modeling/BeamMapping.jpg" alt="" align="left" width="700" class="inline"/> <br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
<br  />
</p>
<p><br  />
</p>
<h1><a class="anchor" id="autotoc_md19"></a>
References</h1>
<ol type="1">
<li>F. Andersson, <em>Bézier and B-spline Technology</em>, PhD thesis, Juin 2003</li>
<li>J. Przemieniecki. <em>Theory of matrix structural analysis. McGraw-Hill</em>, 1985.</li>
<li>T. W. Sederberg, <em>Computer Aided Geometric Design</em>, 2011 ed.</li>
<li>T-Spline, <a href="http://www.tsplines.com/">http://www.tsplines.com/</a></li>
<li>T.Belytschko, W. K. Liu, and B. Moran, <em>Nonlinear Finite Elements for continua and structures</em>, 2000. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 26 2025 11:17:39 for BeamAdapter by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
